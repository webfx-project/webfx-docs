
[.text-center]
[graphviz, webfx-stack, format=svg]
----
digraph D {
    graph [compound=true, ranksep=0.3, nodesep=0.2, fontname=monospace, fontsize=10]
    node [shape="rectangle", style="rounded,filled", fillcolor="#f5dd90", fontname=monospace, fontsize=10]

    subgraph cluster_C {
        label = "Client"

        subgraph cluster_NonUI {
            label = "Non-UI"
            style = "dashed"

            Authn
            Authz
            DB
            ORM
            Push
            QueryPush

            {rank=same Authz ORM}
            {rank=same QueryPush Authn}
            {rank=same Push DB}
            Push -> DB [style=invis]

            Authz -> ORM [style=invis]
            Authn -> QueryPush [style=invis]

            ORM -> DB
            ORM -> QueryPush
            QueryPush -> Push
            QueryPush -> DB
        }

        subgraph cluster_UI {
            label = "UI"
            style = "dashed"

            Validation
            Routing
            I18n
            Action

            {rank=same Validation Routing I18n Action}
            I18n -> Action [minlen=2]
            Validation -> Routing -> I18n [style=invis]
        }

        subgraph cluster_P {
            style = "dashed"
            label = "              Platform"

            WindowHistory
            WindowLocation
            PBR [label="PBRRRRRRRRRRRRRRR",style=invis]
            WebAssembly
            WebWorker

            {rank=same WindowHistory WindowLocation}
            {rank=same PBR WebAssembly WebWorker}
            WebAssembly -> WebWorker -> PBR [style=invis]
            WindowHistory -> WebAssembly [style=invis]
        }

    }

    subgraph cluster_SHR {
        label = "Shared          "

        Async
        Com

        subgraph cluster_SHRP {
            label = "Platform"
            style = "dashed"

            Json
        }

        {rank=same Async Com}
        Async -> Com [style=invis]
        Com -> Json [style=invis, constraint=false]
    }

    subgraph cluster_S {
        label = "Server"

        DBS [label="DB (server)"]
        PushS [label="Push (server)"]
        QueryPushS [label="QueryPush (server)"]

        subgraph cluster_I {
            label = "Implementation"
            style = "dashed"

            Vertx [label="Vert.x"]
        }

        {rank=same DBS PushS}
        PushS -> DBS [style=invis]

        QueryPushS -> PushS
        QueryPushS -> DBS
        QueryPushS -> Vertx [style=invis,len=2]
    }

    Routing -> WindowLocation
    Routing -> WindowHistory

    PBR -> Com [ltail=cluster_C,style=dashed,minlen=2]
    Com -> QueryPushS [lhead=cluster_S,style=dashed,minlen=2]

    Authz -> Action [constraint=false] // Double edge! Why?
}
----